module.exports=function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Credentials=e.Client=void 0;var a=function(){function t(t,e){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(5),n(4);var c=n(1),f=r(c),l=n(2),h=r(l),d=n(7),p=r(d),y=n(3),v=n(9),m=(e.Client=function(){function t(e,n){s(this,t),this.credentials=new b(e,n),this.sessionToken=(0,y.generateUUID)(),this.sendInstallationInfo(),this.pushChannels=new p.PushChannelManager(this.credentials)}return u(t,[{key:"call",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new h.InstallationTracking;return r.getInstallationId().then(function(r){return e.doCall(r,t,n)})}},{key:"doCall",value:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null==e||void 0==e||""==e.trim())throw new Error("API method cannot be empty.");var o=this.credentials.getApiKey(),i=f.ClientBaseUrl+("/b2.2/"+o+"/"+e+".json"),s=new Headers;s.append("Authorization",this.credentials.authString),s.append("Content-Type","application/x-www-form-urlencoded");var a=(0,y.urlEncodedParams)({installId:t,sessionToken:this.sessionToken,params:r}),u={method:"POST",headers:s,body:a};return fetch(i,u).then(function(t){return n.checkStatus(t)}).then(function(t){return n.parseJson(t)}).then(function(t){return n.handleResponse(t)}).catch(function(t){throw t})}},{key:"pushStoreToken",value:function(t){var e=new p.Push(this.credentials);return e.pushStoreToken(t)}},{key:"pushRemoveToken",value:function(){var t=new p.Push(this.credentials);return t.pushRemoveToken()}},{key:"pushTrackOpen",value:function(t){var e=new p.Push(this.credentials);return e.pushTrackOpen(t)}},{key:"sendInstallationInfo",value:function(){var t=this,e=new h.InstallationTracking;Promise.all([e.getInstallationId(),e.getDeviceInfo()]).then(function(e){var n=a(e,2),r=n[0],o=n[1];t.saveInstallationInfo(r,o)}).catch(function(t){return console.error(t)})}},{key:"saveInstallationInfo",value:function(t,e){var n=this,r=f.StatBaseUrl+("/v1/app-installs/"+t),o=JSON.stringify(e),i=new Headers;i.append("Authorization",this.credentials.authString),i.append("Content-Type","application/json; charset=utf-8");var s={method:"PUT",headers:i,body:o};fetch(r,s).then(function(t){return n.checkStatus(t)}).catch(function(t){console.error(t.message)})}},{key:"checkStatus",value:function(t){if(t.status>=200&&t.status<300)return t;var e=new m(t.statusText);throw e.response=t,e}},{key:"parseJson",value:function(t){return t.json()}},{key:"handleResponse",value:function(t){switch(null!=t.sessionToken&&(this.sessionToken=t.sessionToken),t.responseCode){case f.ResponseCode.SUCCESS:return t.payload;default:return Promise.reject(t)}}}]),t}(),function(t){function e(){return s(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return i(e,t),e}(Error)),b=e.Credentials=function(){function t(e,n){if(s(this,t),null==e||void 0==e||""==e.trim())throw new Error("API Key cannot be empty.");if(null==n||void 0==n||""==n.trim())throw new Error("Secret Key cannot be empty.");this.apiKey=e,this.secretKey=n,this.authString=this.getAuthorizationString()}return u(t,[{key:"getAuthorizationString",value:function(){return"Basic "+v.Base64.encode(this.apiKey+":"+this.secretKey)}},{key:"getApiKey",value:function(){return this.apiKey}}]),t}()},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=e.ResponseCode=void 0;!function(t){t[t.SUCCESS=1]="SUCCESS",t[t.NOT_AUTHORIZED=2]="NOT_AUTHORIZED",t[t.NO_SUCH_METHOD=4]="NO_SUCH_METHOD",t[t.NO_SUCH_FORMAT=8]="NO_SUCH_FORMAT",t[t.ACCOUNT_SUSPENDED=16]="ACCOUNT_SUSPENDED",t[t.INVALID_REQUEST=32]="INVALID_REQUEST",t[t.UNKNOWN_SERVER_ERROR=64]="UNKNOWN_SERVER_ERROR",t[t.DATABASE_ERROR=128]="DATABASE_ERROR"}(n||(e.ResponseCode=n={}));var r=e.DeviceType=void 0;!function(t){t[t.IOS=1]="IOS",t[t.ANDROID=6]="ANDROID",t[t.UNKNOWN=4]="UNKNOWN"}(r||(e.DeviceType=r={}));var o=e.OSType=void 0;!function(t){t[t.IOS=1]="IOS",t[t.OSX=2]="OSX",t[t.ANDROID=3]="ANDROID",t[t.WINDOWSPHONE=4]="WINDOWSPHONE",t[t.WINDOWS=5]="WINDOWS"}(o||(e.OSType=o={}));var i=e.SDKTypes=void 0;!function(t){t[t.OBJECTIVEC=1]="OBJECTIVEC",t[t.JAVA=2]="JAVA",t[t.CSHARP=3]="CSHARP",t[t.SWIFT=4]="SWIFT",t[t.JAVASCRIPTTRIGGERIO=5]="JAVASCRIPTTRIGGERIO",t[t.JAVASCRIPTCORDOVA=6]="JAVASCRIPTCORDOVA"}(i||(e.SDKTypes=i={}));var s=e.RuntimeTypes=void 0;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NATIVE=1]="NATIVE",t[t.XAMARIN=2]="XAMARIN",t[t.CORDOVA=3]="CORDOVA",t[t.JAVA=4]="JAVA",t[t.TRIGGERIO=5]="TRIGGERIO"}(s||(e.RuntimeTypes=s={}));var a=e.BuildTargetTypes=void 0;!function(t){t[t.DEBUG=1]="DEBUG",t[t.RELEASE=2]="RELEASE"}(a||(e.BuildTargetTypes=a={}));var u=e.SupportedPushTokenTypes=void 0;!function(t){t[t.IOS=1]="IOS",t[t.ANDROID=2]="ANDROID"}(u||(e.SupportedPushTokenTypes=u={}));var c=e.SupportedIOSPushTokenTypes=void 0;!function(t){t[t.PRODUCTION=1]="PRODUCTION",t[t.DEVELOPMENT=2]="DEVELOPMENT",t[t.ADHOC=3]="ADHOC",t[t.WILDCARD=4]="WILDCARD"}(c||(e.SupportedIOSPushTokenTypes=c={}));e.PushBaseUrl="https://push.kumulos.com",e.StatBaseUrl="https://stats.kumulos.com",e.ClientBaseUrl="https://api.kumulos.com"},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.DeviceInfo=e.OS=e.Runtime=e.SDK=e.Application=e.InstallationInfo=e.InstallationTracking=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(1),a=r(s),u=n(6),c=r(u),f=n(3),l=r(f),h=(e.InstallationTracking=function(){function t(){var e=this;o(this,t),this.getDeviceInfo=function(){return new Promise(function(t,n){var r=new h,o=e.getPlatform();window.kumulosSdk.getDeviceInfo(function(e){r.app.target=a.BuildTargetTypes.DEBUG,r.app.version=window.AppVersion.version,r.sdk.id=a.SDKTypes.JAVASCRIPTCORDOVA,r.sdk.version="1.1.0",r.runtime.id=a.RuntimeTypes.CORDOVA,r.runtime.version=window.device.cordova,r.os.id=o,r.os.version=window.device.version,r.device.name=window.device.model,r.device.isSimulator=window.device.isVirtual,r.device.tz=e.timeZone,t(r)})})},this.getInstallationId=function(){return new Promise(function(t,n){var r="InstallationId.txt",o=window.cordova.file.dataDirectory,i=new c.FileIO(o,r);i.read().then(function(n){null!=n&&""!=n?t(n):e.writeIdToFile(i).then(function(e){t(e)})}).catch(function(r){r==FileError.NOT_FOUND_ERR?e.writeIdToFile(i).then(function(e){t(e)}):(console.log(r),n(r))})})}}return i(t,[{key:"getPlatform",value:function(){var t=window.device.platform;if(null!=t){if(t=t.toLowerCase(),t.indexOf("android")!=-1)return a.OSType.ANDROID;if(t.indexOf("ios")!=-1)return a.OSType.IOS;if(t.indexOf("mac os x")!=-1||t.indexOf("osx"))return a.OSType.OSX;if(t.indexOf("wince")!=-1)return a.OSType.WINDOWSPHONE}}},{key:"writeIdToFile",value:function(t){var e=l.generateUUID();return new Promise(function(n,r){t.write(e).then(function(t){n(t)})})}}]),t}(),e.InstallationInfo=function t(){o(this,t),this.app=new d,this.sdk=new p,this.runtime=new y,this.os=new v,this.device=new m}),d=e.Application=function t(){o(this,t)},p=e.SDK=function t(){o(this,t)},y=e.Runtime=function t(){o(this,t)},v=e.OS=function t(){o(this,t)},m=e.DeviceInfo=function t(){o(this,t)}},function(t,e){"use strict";function n(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=Object.keys(t),i=[],s=void 0,a=void 0,u=void 0,c=void 0,f=0,l=o.length;f<l;++f)a=o[f],s=t[a],"object"!==("undefined"==typeof s?"undefined":r(s))?(u=null!==e?encodeURIComponent(e)+"["+encodeURIComponent(a)+"]":encodeURIComponent(a),c=encodeURIComponent(s),i.push(u+"="+c)):i.push(n(s,a));return i.join("&")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.urlEncodedParams=n;e.generateUUID=function(){var t=(new Date).getTime();window.performance&&"function"==typeof window.performance.now&&(t+=performance.now());var e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return e}},function(t,e,n){"use strict";t.exports=n(8).polyfill()},function(t,e){!function(t){"use strict";function e(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return m.iterable&&(e[Symbol.iterator]=function(){return e}),e}function o(t){this.map={},t instanceof o?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function i(t){return t.bodyUsed?Promise.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function a(t){var e=new FileReader,n=s(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=s(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(m.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(m.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(m.arrayBuffer&&m.blob&&w(t))this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!T(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var t=i(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(t){var e=t.toUpperCase();return g.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var n=e.body;if("string"==typeof t)this.url=t;else{if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new o(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new o(e.headers)),this.method=h(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function y(t){var e=new o;return t.split("\r\n").forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e}function v(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new o(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var m={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(m.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=function(t){return t&&DataView.prototype.isPrototypeOf(t)},T=ArrayBuffer.isView||function(t){return t&&b.indexOf(Object.prototype.toString.call(t))>-1};o.prototype.append=function(t,r){t=e(t),r=n(r);var o=this.map[t];o||(o=[],this.map[t]=o),o.push(r)},o.prototype.delete=function(t){delete this.map[e(t)]},o.prototype.get=function(t){var n=this.map[e(t)];return n?n[0]:null},o.prototype.getAll=function(t){return this.map[e(t)]||[]},o.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},o.prototype.set=function(t,r){this.map[e(t)]=[n(r)]},o.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(r){t.call(e,r,n,this)},this)},this)},o.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},o.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},o.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},m.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},l.call(d.prototype),l.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},v.error=function(){var t=new v(null,{status:0,statusText:""});return t.type="error",t};var O=[301,302,303,307,308];v.redirect=function(t,e){if(O.indexOf(e)===-1)throw new RangeError("Invalid status code");return new v(null,{status:e,headers:{location:t}})},t.Headers=o,t.Request=d,t.Response=v,t.fetch=function(t,e){return new Promise(function(n,r){var o=new d(t,e),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:y(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;n(new v(e,t))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&m.blob&&(i.responseType="blob"),o.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.FileIO=function(){function t(e,r){var o=this;n(this,t),this.fileSystem=null,this.read=function(){return new Promise(function(t,e){window.resolveLocalFileSystemURL(o.filePath,function(e){o.readFile(e).then(function(e){t(e)})},function(t){console.dir(t),console.log(t),e(t.code)})})},this.fileName=r,this.fileDirectory=e,this.filePath=e+"/"+r}return r(t,[{key:"write",value:function(t){var e=this;return new Promise(function(n,r){window.resolveLocalFileSystemURL(e.fileDirectory,function(r){r.getFile(e.fileName,{create:!0,exclusive:!1},function(r){e.writeFile(r,t).then(function(t){n(t)})})})})}},{key:"writeFile",value:function(t,e){var n=this;return new Promise(function(r,o){t.createWriter(function(i){var s=null;if(e){var s=new Blob([e],{type:"text/plain"});i.write(s)}i.onwriteend=function(){var e=n.readFile(t);r(e)},i.onerror=function(t){o(t)}})})}},{key:"readFile",value:function(t){return new Promise(function(e,n){t.file(function(t){var n=new FileReader;n.onloadend=function(){e(this.result)},n.readAsText(t)})})}}]),t}()},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.PushChannelManager=e.Push=void 0;var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(5),n(4);var s=n(1),a=r(s),u=n(2),c=r(u);e.Push=function(){function t(e){var n=this;o(this,t),this.pushStoreToken=function(e){if(!e)throw new Error("Token cannot be null.");return new Promise(function(r,o){var i=new c.InstallationTracking,s=n.headers;i.getInstallationId().then(function(n){var o=i.getPlatform(),u=null,c=a.PushBaseUrl+("/v1/app-installs/"+n+"/push-token");if(o==a.OSType.ANDROID){u=a.SupportedPushTokenTypes.ANDROID;var f=t.getOptions(e,u,null,s);r(fetch(c,f))}else o==a.OSType.IOS&&(u=a.SupportedPushTokenTypes.IOS,window.kumulosSdk.getDeviceInfo(function(n){var o=n.iOSTokenType,i=t.getOptions(e,u,o,s);r(fetch(c,i))}))})})},this.headers=new Headers,this.headers.append("Authorization",e.authString),this.headers.append("Content-Type","application/json; charset=utf-8")}return i(t,[{key:"pushRemoveToken",value:function(){var t=this.headers;return new Promise(function(e,n){var r=new c.InstallationTracking;r.getInstallationId().then(function(n){var o=(r.getInstallationId(),a.PushBaseUrl+("/v1/app-installs/"+n+"/push-token")),i={method:"DELETE",headers:t};e(fetch(o,i))})})}},{key:"pushTrackOpen",value:function(t){if(!t)throw new Error("Notification Id cannot be null.");var e=this.headers;return new Promise(function(n,r){var o=new c.InstallationTracking;o.getInstallationId().then(function(r){var o=a.PushBaseUrl+("/v1/app-installs/"+r+"/opens"),i={id:t},s=JSON.stringify(i),u={method:"POST",headers:e,body:s};n(fetch(o,u))})})}}],[{key:"getOptions",value:function(t,e,n,r){var o={token:t,type:e,iosTokenType:n},i=JSON.stringify(o);return{method:"PUT",headers:r,body:i}}}]),t}(),e.PushChannelManager=function(){function t(e){o(this,t),this.headers=new Headers,this.headers.append("Authorization",e.authString),this.headers.append("Content-Type","application/json; charset=utf-8"),this.headers.append("Accept","application/json"),this.installationTracking=new c.InstallationTracking}return i(t,[{key:"makeSubscriptionRequest",value:function(t,e){var n=this;return this.installationTracking.getInstallationId().then(function(r){var o=a.PushBaseUrl+"/v1/app-installs/"+r+"/channels/subscriptions",i={uuids:e},s={method:t,headers:n.headers,body:JSON.stringify(i)};return fetch(o,s)})}},{key:"subscribe",value:function(t){return this.makeSubscriptionRequest("POST",t)}},{key:"unsubscribe",value:function(t){return this.makeSubscriptionRequest("DELETE",t)}},{key:"setSubscriptions",value:function(t){return this.makeSubscriptionRequest("PUT",t)}},{key:"clearSubscriptions",value:function(){return this.setSubscriptions([])}},{key:"listChannels",value:function(){var t=this;return this.installationTracking.getInstallationId().then(function(e){var n=a.PushBaseUrl+"/v1/app-installs/"+e+"/channels",r={method:"GET",headers:t.headers};return fetch(n,r)}).then(function(t){return t.json()})}},{key:"createChannel",value:function(t){var e=this;return!t.showInPortal||t.name&&t.name.length?this.installationTracking.getInstallationId().then(function(n){var r=a.PushBaseUrl+"/v1/channels",o={uuid:t.uuid,name:t.name,showInPortal:Boolean(t.showInPortal),meta:t.meta,installId:void 0};t.subscribe&&(o.installId=n);var i={method:"POST",headers:e.headers,body:JSON.stringify(o)};return fetch(r,i)}).then(function(t){return t.json()}):Promise.reject({error:"Name is required for channel creation when showInPortal is true"})}}]),t}()},function(t,e,n){(function(e,r){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	 * @version   4.0.5
	 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function i(t){X=t}function s(t){Z=t}function a(){return function(){return e.nextTick(h)}}function u(){return"undefined"!=typeof z?function(){z(h)}:l()}function c(){var t=0,e=new $(h),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function f(){var t=new MessageChannel;return t.port1.onmessage=h,function(){return t.port2.postMessage(0)}}function l(){var t=setTimeout;return function(){return t(h,1)}}function h(){for(var t=0;t<q;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}q=0}function d(){try{var t=n(11);return z=t.runOnLoop||t.runOnContext,u()}catch(t){return l()}}function p(t,e){var n=arguments,r=this,o=new this.constructor(v);void 0===o[ot]&&B(o);var i=r._state;return i?!function(){var t=n[i-1];Z(function(){return k(i,o,t,r._result)})}():P(r,o,t,e),o}function y(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(v);return A(n,t),n}function v(){}function m(){return new TypeError("You cannot resolve a promise with itself")}function b(){return new TypeError("A promises callback cannot return that same promise.")}function w(t){try{return t.then}catch(t){return ut.error=t,ut}}function T(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function g(t,e,n){Z(function(t){var r=!1,o=T(n,e,function(n){r||(r=!0,e!==n?A(t,n):I(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function O(t,e){e._state===st?I(t,e._result):e._state===at?E(t,e._result):P(e,void 0,function(e){return A(t,e)},function(e){return E(t,e)})}function S(t,e,n){e.constructor===t.constructor&&n===p&&e.constructor.resolve===y?O(t,e):n===ut?E(t,ut.error):void 0===n?I(t,e):o(n)?g(t,e,n):I(t,e)}function A(e,n){e===n?E(e,m()):t(n)?S(e,n,w(n)):I(e,n)}function _(t){t._onerror&&t._onerror(t._result),R(t)}function I(t,e){t._state===it&&(t._result=e,t._state=st,0!==t._subscribers.length&&Z(R,t))}function E(t,e){t._state===it&&(t._state=at,t._result=e,Z(_,t))}function P(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+st]=n,o[i+at]=r,0===i&&t._state&&Z(R,t)}function R(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?k(n,r,o,i):o(i);t._subscribers.length=0}}function C(){this.error=null}function D(t,e){try{return t(e)}catch(t){return ct.error=t,ct}}function k(t,e,n,r){var i=o(n),s=void 0,a=void 0,u=void 0,c=void 0;if(i){if(s=D(n,r),s===ct?(c=!0,a=s.error,s=null):u=!0,e===s)return void E(e,b())}else s=r,u=!0;e._state!==it||(i&&u?A(e,s):c?E(e,a):t===st?I(e,s):t===at&&E(e,s))}function x(t,e){try{e(function(e){A(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}function U(){return ft++}function B(t){t[ot]=ft++,t._state=void 0,t._result=void 0,t._subscribers=[]}function N(t,e){this._instanceConstructor=t,this.promise=new t(v),this.promise[ot]||B(this.promise),G(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?I(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&I(this.promise,this._result))):E(this.promise,j())}function j(){return new Error("Array Methods must be provided an Array")}function F(t){return new N(this,t).promise}function M(t){var e=this;return new e(G(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function V(t){var e=this,n=new e(v);return E(n,t),n}function L(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function H(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function K(t){this[ot]=U(),this._result=this._state=void 0,this._subscribers=[],v!==t&&("function"!=typeof t&&L(),this instanceof K?x(this,t):H())}function W(){var t=void 0;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=K}var J=void 0;J=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var G=J,q=0,z=void 0,X=void 0,Z=function(t,e){nt[q]=t,nt[q+1]=e,q+=2,2===q&&(X?X(h):rt())},Y="undefined"!=typeof window?window:void 0,Q=Y||{},$=Q.MutationObserver||Q.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),rt=void 0;rt=tt?a():$?c():et?f():void 0===Y?d():l();var ot=Math.random().toString(36).substring(16),it=void 0,st=1,at=2,ut=new C,ct=new C,ft=0;return N.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===it&&n<t;n++)this._eachEntry(e[n],n)},N.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===y){var o=w(t);if(o===p&&t._state!==it)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===K){var i=new n(v);S(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},N.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===it&&(this._remaining--,t===at?E(r,n):this._result[e]=n),0===this._remaining&&I(r,this._result)},N.prototype._willSettleAt=function(t,e){var n=this;P(t,void 0,function(t){return n._settledAt(st,e,t)},function(t){return n._settledAt(at,e,t)})},K.all=F,K.race=M,K.resolve=y,K.reject=V,K._setScheduler=i,K._setAsap=s,K._asap=Z,K.prototype={constructor:K,then:p,catch:function(t){return this.then(null,t)}},K.polyfill=W,K.Promise=K,K})}).call(e,n(10),function(){return this}())},function(t,e){!function(t){"use strict";var e,n=t.Base64,r="2.1.9",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=function(t){for(var e={},n=0,r=t.length;n<r;n++)e[t.charAt(n)]=n;return e}(o),s=String.fromCharCode,a=function(t){if(t.length<2){var e=t.charCodeAt(0);return e<128?t:e<2048?s(192|e>>>6)+s(128|63&e):s(224|e>>>12&15)+s(128|e>>>6&63)+s(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return s(240|e>>>18&7)+s(128|e>>>12&63)+s(128|e>>>6&63)+s(128|63&e)},u=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return t.replace(u,a)},f=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),r=[o.charAt(n>>>18),o.charAt(n>>>12&63),e>=2?"=":o.charAt(n>>>6&63),e>=1?"=":o.charAt(63&n)];return r.join("")},l=t.btoa?function(e){return t.btoa(e)}:function(t){return t.replace(/[\s\S]{1,3}/g,f)},h=e?function(t){return(t.constructor===e.constructor?t:new e(t)).toString("base64")}:function(t){return l(c(t))},d=function(t,e){return e?h(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):h(String(t))},p=function(t){return d(t,!0)},y=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),v=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return s((n>>>10)+55296)+s((1023&n)+56320);case 3:return s((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return s((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},m=function(t){return t.replace(y,v)},b=function(t){var e=t.length,n=e%4,r=(e>0?i[t.charAt(0)]<<18:0)|(e>1?i[t.charAt(1)]<<12:0)|(e>2?i[t.charAt(2)]<<6:0)|(e>3?i[t.charAt(3)]:0),o=[s(r>>>16),s(r>>>8&255),s(255&r)];return o.length-=[0,0,2,1][n],o.join("")},w=t.atob?function(e){return t.atob(e)}:function(t){return t.replace(/[\s\S]{1,4}/g,b)},T=e?function(t){return(t.constructor===e.constructor?t:new e(t,"base64")).toString()}:function(t){return m(w(t))},g=function(t){return T(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},O=function(){var e=t.Base64;return t.Base64=n,e};if(t.Base64={VERSION:r,atob:w,btoa:l,fromBase64:g,toBase64:d,utob:c,encode:d,encodeURI:p,btou:m,decode:g,noConflict:O},"function"==typeof Object.defineProperty){var S=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",S(function(){return g(this)})),Object.defineProperty(String.prototype,"toBase64",S(function(t){return d(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",S(function(){return d(this,!0)}))}}t.Meteor&&(Base64=t.Base64)}(this)},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(f===setTimeout)return setTimeout(t,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(t,0);try{return f(t,0)}catch(e){try{return f.call(null,t,0)}catch(e){return f.call(this,t,0)}}}function i(t){if(l===clearTimeout)return clearTimeout(t);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){y&&d&&(y=!1,d.length?p=d.concat(p):v=-1,p.length&&a())}function a(){if(!y){var t=o(s);y=!0;for(var e=p.length;e;){for(d=p,p=[];++v<e;)d&&d[v].run();v=-1,e=p.length}d=null,y=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var f,l,h=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(t){f=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(t){l=r}}();var d,p=[],y=!1,v=-1;h.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||y||o(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.binding=function(t){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(t){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(t,e){}]);